<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
<title>CIVITAS: RUINES</title>

<style>
  :root{
    /* Option B: stratégique immersive */
    --bg0:#07090d;
    --bg1:#0f1115;
    --bg2:#141822;

    --panel0: rgba(18, 22, 30, .86);
    --panel1: rgba(24, 29, 40, .78);
    --panelBorder: rgba(255,255,255,.10);

    --text:#e8e6df;
    --muted: rgba(232,230,223,.72);

    --accent:#b08a5a;      /* cuivre */
    --good:#3f7a5a;        /* vert éteint */
    --warn:#8b6a2f;        /* ocre */
    --danger:#8b3a3a;      /* rouge éteint */
    --line: rgba(255,255,255,.12);

    --shadow: rgba(0,0,0,.55);
  }

  *{ box-sizing:border-box; }
  html, body { height:100%; }
  body{
    margin:0;
    overflow:hidden; /* ✅ jamais de scroll */
    font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;
    color: var(--text);
    background:
      radial-gradient(1200px 800px at 20% 20%, rgba(255,255,255,.06), transparent 60%),
      radial-gradient(900px 700px at 80% 30%, rgba(255,255,255,.04), transparent 62%),
      radial-gradient(1400px 900px at 50% 95%, rgba(0,0,0,.35), rgba(0,0,0,.92)),
      linear-gradient(180deg, var(--bg1), var(--bg0));
  }

  /* Overlay de texture légère */
  body::before{
  content:"";
  position:absolute; /* IMPORTANT : plus de fixed */
  inset:0;
  background:
    repeating-linear-gradient(
      0deg,
      rgba(255,255,255,.02) 0 1px,
      transparent 1px 5px
    ),
    radial-gradient(
      circle at 30% 30%,
      rgba(176,138,90,.06),
      transparent 55%
    ),
    radial-gradient(
      circle at 70% 65%,
      rgba(90,160,200,.05),
      transparent 60%
    );
  opacity:.55;
  pointer-events:none;
}
    

  /* Frame */
  .frame{
    position:relative;
    height:100%;
    padding: max(10px, env(safe-area-inset-top)) 10px max(10px, env(safe-area-inset-bottom));
    display:flex;
    align-items:center;
    justify-content:center;
  }

  /* “Plateau” du jeu */
  .board{
    width:min(1200px, 96vw);
    height:min(860px, 96vh);
    border-radius:18px;
    background:
      radial-gradient(1200px 700px at 30% 20%, rgba(255,255,255,.04), transparent 60%),
      linear-gradient(180deg, rgba(255,255,255,.04), rgba(0,0,0,.10));
    box-shadow: 0 28px 90px var(--shadow);
    border: 1px solid rgba(255,255,255,.10);
    overflow:hidden;
    position:relative;
  }

  /* Layout global: HUD / contenu / actions */
  .ui{
    position:absolute; inset:0;
    display:grid;
    grid-template-rows: auto 1fr auto;
    gap:10px;
    padding:12px;
  }

  /* === Screen “rotate” si portrait === */
  .rotate{
    position:absolute; inset:0;
    display:none;
    align-items:center; justify-content:center;
    background: rgba(0,0,0,.75);
    backdrop-filter: blur(8px);
    z-index:50;
    padding:18px;
    text-align:center;
  }
  .rotateCard{
    width:min(520px, 92vw);
    border:1px solid rgba(255,255,255,.14);
    background: linear-gradient(180deg, rgba(18,22,30,.90), rgba(18,22,30,.70));
    border-radius:16px;
    padding:16px;
  }
  .rotateTitle{
    font-weight:900;
    letter-spacing:.08em;
    text-transform:uppercase;
    color: var(--text);
  }
  .rotateBody{ margin-top:10px; color: var(--muted); line-height:1.3; }
  .rotateIcon{ font-size:32px; margin:12px 0 0; }

  @media (orientation: portrait){
    .rotate{ display:flex; }
  }

  /* === HUD TOP === */
  .hud{
    border-radius:14px;
    border: 1px solid var(--panelBorder);
    background: linear-gradient(180deg, var(--panel0), var(--panel1));
    backdrop-filter: blur(6px);
    padding:10px 12px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:10px;
  }
  .hudLeft{
    display:flex;
    flex-direction:column;
    gap:2px;
    min-width:0;
  }
  .hudTitle{
    font-weight:900;
    letter-spacing:.03em;
    white-space:nowrap;
    overflow:hidden;
    text-overflow:ellipsis;
  }
  .hudMeta{
    font-size:12px;
    color: var(--muted);
    white-space:nowrap;
    overflow:hidden;
    text-overflow:ellipsis;
  }
  .pills{
    display:flex;
    gap:8px;
    flex-wrap:wrap;
    justify-content:flex-end;
  }
  .pill{
    font-size:12px;
    padding:7px 10px;
    border-radius:999px;
    border:1px solid rgba(255,255,255,.12);
    background: rgba(255,255,255,.06);
    white-space:nowrap;
  }
  .pill b{ color: var(--accent); font-weight:900; }

  /* === CONTENT === */
  .content{
    display:grid;
    grid-template-columns: 1.45fr 0.85fr; /* carte / panneau */
    gap:10px;
    min-height:0;
  }
  @media (max-width: 900px){
    .content{ grid-template-columns: 1.25fr 0.95fr; }
  }

  /* Map */
  .map{
    border-radius:14px;
    border:1px solid rgba(255,255,255,.10);
    overflow:hidden;
    position:relative;
    background:
      radial-gradient(900px 600px at 18% 22%, rgba(255,255,255,.08), transparent 58%),
      linear-gradient(180deg, rgba(0,0,0,.10), rgba(0,0,0,.35));
  }
  .map svg{ width:100%; height:100%; display:block; }

  .mapBrand{
    position:absolute;
    top:10px; left:10px;
    padding:8px 10px;
    border-radius:12px;
    border:1px solid rgba(255,255,255,.12);
    background: rgba(0,0,0,.25);
    backdrop-filter: blur(6px);
    font-weight:900;
    letter-spacing:.06em;
    text-transform:uppercase;
    font-size:12px;
    color: var(--text);
  }

  /* Right panel */
  .panel{
    border-radius:14px;
    border: 1px solid var(--panelBorder);
    background: linear-gradient(180deg, var(--panel0), var(--panel1));
    backdrop-filter: blur(6px);
    padding:10px;
    display:flex;
    flex-direction:column;
    gap:10px;
    min-height:0;
  }

  .block{
    border-radius:12px;
    border: 1px solid rgba(255,255,255,.10);
    background: rgba(255,255,255,.05);
    padding:10px;
  }
  .blockTitle{
    font-weight:900;
    letter-spacing:.08em;
    text-transform:uppercase;
    font-size:12px;
    color: rgba(232,230,223,.90);
  }
  .blockBody{
    margin-top:8px;
    font-size:13px;
    line-height:1.25;
    color: rgba(232,230,223,.88);
  }
  .kv{
    display:flex;
    justify-content:space-between;
    gap:10px;
    font-size:12px;
    color: var(--muted);
    margin-top:6px;
  }
  .kv span:last-child{ color: rgba(232,230,223,.86); }

  .tagRow{
    display:flex;
    gap:8px;
    flex-wrap:wrap;
    margin-top:8px;
  }
  .tag{
    font-size:11px;
    padding:6px 8px;
    border-radius:999px;
    border:1px solid rgba(255,255,255,.10);
    background: rgba(255,255,255,.06);
    color: rgba(232,230,223,.85);
  }
  .tag.good{ border-color: rgba(63,122,90,.35); color: rgba(160,220,190,.95); }
  .tag.warn{ border-color: rgba(139,106,47,.35); color: rgba(230,200,140,.95); }
  .tag.danger{ border-color: rgba(139,58,58,.35); color: rgba(240,170,170,.95); }

  /* === ACTION BAR === */
  .actions{
    border-radius:14px;
    border: 1px solid var(--panelBorder);
    background: linear-gradient(180deg, rgba(18,22,30,.62), rgba(18,22,30,.92));
    backdrop-filter: blur(6px);
    padding:10px;
    display:grid;
    grid-template-columns: repeat(4, 1fr);
    gap:10px;
  }

  .action{
    border-radius:12px;
    border:1px solid rgba(255,255,255,.12);
    background: rgba(255,255,255,.06);
    padding:10px;
    height:70px;
    display:flex;
    flex-direction:column;
    justify-content:center;
    gap:4px;
  }
  .aTitle{
    font-weight:900;
    font-size:13px;
    color: rgba(232,230,223,.95);
  }
  .aDesc{
    font-size:11px;
    color: var(--muted);
    white-space:nowrap;
    overflow:hidden;
    text-overflow:ellipsis;
  }
  .aRisk{
    font-size:11px;
    margin-top:2px;
    color: rgba(232,230,223,.85);
  }
  .riskDot{
    display:inline-block;
    width:8px; height:8px;
    border-radius:999px;
    margin-right:6px;
    transform: translateY(1px);
    background: var(--warn);
  }
  .riskDot.high
